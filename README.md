# About

Provides functionality for some of the more tedious requirements when building a Shopify app such as consistent hmac validation behavior for authentication, proxies, etc. It is mostly built as express-style middleware but if there is demand could easily be provided in a generic form as well.

This is not meant to be a *batteries included* solution. For that checkout [`shopify-express`](https://github.com/Shopify/shopify-express)

# Installation

Note: requires NodeJS >= 8.6.0

`npm install @satel/shopify-app-utils`

or

`yarn add @satel/shopify-app-utils`

# Documentation

<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [computeHMAC](#computehmac)
    -   [Parameters](#parameters)
    -   [Examples](#examples)
-   [authHMACMiddleware](#authhmacmiddleware)
    -   [Parameters](#parameters-1)
    -   [Examples](#examples-1)
-   [proxyHMACMiddleware](#proxyhmacmiddleware)
    -   [Parameters](#parameters-2)
    -   [Examples](#examples-2)

## computeHMAC

Produces a hex encoded Sha256 hmac

### Parameters

-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `options.text` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
    -   `options.secret` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### Examples

```javascript
const hash = computeHMAC({
  text: 'message',
  secret: 'hush',
});
```

Returns **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

## authHMACMiddleware

-   **See: <https://help.shopify.com/en/api/getting-started/authentication/oauth#verification>**

Express style middleware for validating auth related calls from Shopify. It will set a `validSignature` flag on the express `request` object

### Parameters

-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `options.secret` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### Examples

```javascript
app.use(authHMACMiddleware({
  secret: 'hush',
}));

app.get('*', req => {
  if (req.validSignature !== true) {
    // Forged request
  }
  // From Shopify
});
```

## proxyHMACMiddleware

-   **See: <https://help.shopify.com/en/api/guides/application-proxies>**

Express style middleware for validating proxied requests from Shopify. It will set a `validSignature` flag on the express `request` object

### Parameters

-   `options` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** 
    -   `options.secret` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 

### Examples

```javascript
app.use(proxyHMACMiddleware({
  secret: 'hush',
}));

app.get('*', req => {
  if (req.validSignature !== true) {
    // Forged request
  }
  // From Shopify
});
```